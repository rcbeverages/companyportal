<script>
  document.getElementById("loginBtn").addEventListener("click", async function login() {
    const username = document.getElementById("username").value.trim();
    const password = document.getElementById("password").value.trim();

    try {
      const response = await fetch("https://sheetdb.io/api/v1/abgzvmn3160g0/search?Username=" + username + "&_nocache=" + Date.now());
      const users = await response.json();

      if (users.length === 0) {
        alert("Username not found.");
        return;
      }

      const correctPassword = users[0].Password;
      const role = users[0].Role;

      if (correctPassword === password) {
        localStorage.setItem("username", username);
        localStorage.setItem("role", role);
        window.location.href = "dashboard.html";
      } else {
        alert("Incorrect password.");
      }
    } catch (err) {
      alert("Something went wrong:\n" + err.message);
      console.error("Error details:", err);
    }
  });
</script>
